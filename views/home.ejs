<!-- adding dedicated css for this page -->
<link rel="stylesheet" href="/css/user_profile.css" />
<!-- here every thing is controll by layout so we dont need that we only need the content shown in body -->
<!-- file inclued from _header.ejs syntax -->
<!-- header and footer area are called layout -->
<!-- <%- include('_header.ejs'); -%> -->

<h1>codeial / <%=title %>
</h1>
<!--  file inclued from _footer.ejs syntax -->
<!-- <%- include('_footer.ejs'); -%> -->

<section id="feed-posts">
  <h4>Posts</h4>
  <% if(locals.user){%>
    <form action="/posts/create" id="new-post-form" method="post">
      <textarea name="content" id="" cols="30" rows="3" placeholder="Type Here..." required></textarea>
      <input type="submit" value="Post" />
    </form>

    <% } %>

      <div id="posts-list-container">
        <ul>
          <% for(post of posts){ %>
            <li>
              <p>

                <!-- for delete the post and comment -->
                <% if(locals.user && locals.user.id==post.user.id){ %>
                <small>
                    <a href="/posts/destroy/<%= post.id %>">XX</a>
                </small>
                <% } %>

                <%= post.content %>
                  <br />
                  <small>
                    <%= post.user.name %>
                  </small>
              </p>
              <div class="post-comments">
                <% if(locals.user){%>
                  <form action="/comments/create" method="Post">
                    <input type="text" name="content" placeholder="Type Here to add comment..." required />
                    <!-- this input name post is given us id for this post and name use in controller of comment -->
                    <input type="hidden" name="post" value="<%= post._id %>" />
                    <input type="submit" value="Add comment" />
                  </form>
                  <% } %>

                  <div class="post-comments-list">
                    <ul id="post-comments-<%= post._id %>">

                      <% for(comment of post.comments ){%>
                        
                        <p>
                          <%= comment.content %>
                          <br>
                          <small>
                            <%= comment.user.name %>
                          </small>
                        </p>
                        
                        <% } %>

                    </ul>
                  </div>

              </div>
            </li>
            <% } %>
        </ul>
      </div>
</section>
